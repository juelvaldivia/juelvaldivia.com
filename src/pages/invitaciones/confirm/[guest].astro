---
import InvitationsLayout from '@/templates/Invitations.astro';
import { AppConfig } from '@/utils/AppConfig';
import { getXataClient } from '@/database/xata';

const { title } = AppConfig;
const { description } = AppConfig;
const guestId = Astro.params.guest;

const xata = getXataClient();
const guest = await xata.db.guests.update(guestId, {
  confirmed: true,
});
const boyUrl = `/invitaciones/boy/${guest.id}/`;
const girlUrl = `/invitaciones/girl/${guest.id}/`;

export async function getStaticPaths() {
  const xata = getXataClient();
  const guests = await xata.db.guests
  .select(["id", "name", "event_id", "confirmed"])
  .getAll()

  return guests.map(guest => {
    return {
      params: {
        guest: guest.id
      }
    }
  })
}
---

<InvitationsLayout head={{ title, description }}>
  <div class="container mx-auto p-4 pt-6 md:p-6 lg:p-12">
  <div class="text-center mb-8">
    <h1 class="text-4xl font-bold">Hola {guest?.name}</h1>
    <p class="text-lg p-4">Estamos muy contentos de que puedas asistir, ahora ayudanos con tu pronóstico:</p>
    <div class="flex justify-center p-8">
      <p class="text-4xl">Será niño o niña?</p>
    </div>
    <div class="flex justify-center space-x-4">
      <a
      href={boyUrl}
      class="bg-blue-300 hover:bg-[#86d1f0] text-white font-bold py-2 px-4 rounded"
      >
        Niño
      </a>
      <a
      href={girlUrl}
      class="bg-pink-400 hover:bg-[#febeda] text-white font-bold py-2 px-4 rounded"
      >
        Niña
      </a>
    </div>
  </div>
  </div>
</InvitationsLayout>
